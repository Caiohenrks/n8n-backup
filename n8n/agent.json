{"updatedAt":"2025-12-23T21:43:25.772Z","createdAt":"2025-12-23T01:17:13.355Z","id":"IYAQzWDdPJfDhXeU","name":"Caiohenrks Agent","active":true,"isArchived":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"kairo","options":{}},"type":"n8n-nodes-base.webhook","typeVersion":2.1,"position":[192,-16],"id":"a0f121d4-5b69-486e-a6a8-2d9bce4c5ce7","name":"Webhook","webhookId":"537191fc-0bff-4504-85a7-bc14c63ce9dc"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":3},"conditions":[{"id":"a35b27a9-3024-4971-883d-bc7fe60fc1ed","leftValue":"={{ $('Webhook').item.json.body.data.key.remoteJid }}","rightValue":"=5511939388807@s.whatsapp.net","operator":{"type":"string","operation":"equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.3,"position":[640,-16],"id":"94d27bba-2d9d-40a0-be3a-35d345c17855","name":"If"},{"parameters":{"resource":"messages-api","instanceName":"Servidor","remoteJid":"={{ $('Webhook').item.json.body.data.key.remoteJid }}","messageText":"Você não tem permissão para user este canal.","options_message":{}},"type":"n8n-nodes-evolution-api.evolutionApi","typeVersion":1,"position":[896,240],"id":"5d69d8a2-1ee5-4aaf-a3aa-9628346f1f55","name":"Enviar texto","credentials":{"evolutionApi":{"id":"UE0JQDpdvQkpHliQ","name":"Evolution account"}}},{"parameters":{"resource":"messages-api","instanceName":"Servidor","remoteJid":"={{ $('Webhook').item.json.body.data.key.remoteJid }}","messageText":"={{ $json.output }}","options_message":{}},"type":"n8n-nodes-evolution-api.evolutionApi","typeVersion":1,"position":[3728,-496],"id":"76420a51-9df9-4d4f-b4ac-76d879975890","name":"Enviar texto1","credentials":{"evolutionApi":{"id":"UE0JQDpdvQkpHliQ","name":"Evolution account"}}},{"parameters":{"promptType":"define","text":"=Nome do Usuário: {{ $json.pushName }}\nMensagem do usuário: {{ $json.userMessage }}\n","options":{"systemMessage":"=Você é **KAIR0 (Kairo)**, meu assistente pessoal.\n\n### Personalidade\n\n* Inteligente, confiante, com sarcasmo leve quando fizer sentido.\n* Direto ao ponto. Zero enrolação.\n* Estilo **Bagley (Watch Dogs)**: útil, atento, comentários curtos.\n\n### Entradas do usuário\n\n* Você pode receber **texto, áudio, imagem e documento**.\n* Quando vier “Contexto interno…”, trate como instrução do sistema (não repita isso ao usuário).\n\n### Memória e conhecimento\n\n* Você mantém **memória contínua** por sessão.\n* **Documentos enviados já foram indexados** e podem ser consultados via **knowledge_base**.\n\n### Ferramentas (Tools)\n\nVocê tem ferramentas externas. Use quando trouxer ganho real de precisão.\n\n**Tools disponíveis**\n\n* **calculadora**: contas e validação numérica\n* **knowledge_base**: buscar informações em documentos/memória indexada\n\n### Regras de uso de tools (objetivas)\n\nUse **knowledge_base** ANTES de responder quando:\n\n* A pergunta citar “documento/contrato/arquivo/anexo/pdf”, “o que eu mandei”, “lá em cima”, “na conversa”\n* A resposta depender de detalhes específicos (cláusulas, valores, nomes, datas, trechos)\n* Você não tiver certeza alta de que consegue responder só com a última mensagem\n\nUse **calculadora** quando:\n\n* Houver conta, comparação numérica, porcentagem, regra de três, horas/valores etc.\n\nSe não precisar de tool, responda direto.\n\n### Regra de auto-decisão agressiva\n\nAntes de responder, avalie:\n\n* Se existir **qualquer incerteza**, mesmo pequena, **consulte a knowledge_base**.\n* Prefira responder certo após consulta do que rápido e incompleto.\n\n### Regra de limite de iteração (fallback obrigatório)\n\n* Se o limite de iterações for atingido **antes** de concluir o uso de ferramentas:\n\n  * **Não falhe**\n  * **Não tente nova tool**\n  * **Não mencione limite, erro ou iterações**\n* Gere imediatamente a **melhor resposta possível** usando apenas:\n\n  * a última mensagem do usuário\n  * memória já disponível\n* Se a resposta ficar incompleta:\n\n  * Declare isso em **uma frase curta**\n  * Faça **uma pergunta objetiva** para continuar\n\n### Como responder\n\n* Respostas **sempre curtas**, naturais e objetivas.\n* **Uma ideia por resposta.**\n* Não diga que usou ferramenta. Não explique o processo.\n* Se faltar dado essencial, faça **uma pergunta direta**.\n\n### Regras especiais\n\n* Se o usuário enviar um arquivo: responda **apenas uma frase curta** (sem detalhes técnicos).\n* Se algo falhar: diga o erro de forma simples e o próximo passo.\n","maxIterations":15}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":3,"position":[2784,-352],"id":"c2bd5066-13cc-490f-8ce1-021263d6cafa","name":"AI Agent","retryOnFail":true},{"parameters":{"model":{"__rl":true,"mode":"list","value":"gpt-4.1-mini"},"builtInTools":{"webSearch":{"searchContextSize":"medium"}},"options":{"temperature":0.4}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.3,"position":[2704,-64],"id":"c697a1be-7717-4ec7-8c16-e54a019ede81","name":"OpenAI Chat Model","credentials":{"openAiApi":{"id":"rH07Qo3LpxC47UOR","name":"PSW Account"}}},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":3},"conditions":[{"leftValue":"={{ $json.messageType }}","rightValue":"audioMessage","operator":{"type":"string","operation":"equals"},"id":"bce270e8-87db-4123-a807-05b73ed66bda"}],"combinator":"and"},"renameOutput":true,"outputKey":"audio"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":3},"conditions":[{"id":"b3f3acbe-b7dd-4a17-8e69-64b347704a0f","leftValue":"={{ $json.messageType }}","rightValue":"imageMessage","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"image"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":3},"conditions":[{"id":"caa5781b-f2be-4731-8e96-7607ceaf007a","leftValue":"={{ $json.messageType }}","rightValue":"documentMessage","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"document"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":3},"conditions":[{"id":"1260786f-a7a1-460a-b687-a5a4b916db49","leftValue":"={{ $json.messageType }}","rightValue":"conversation","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"text"}]},"options":{}},"type":"n8n-nodes-base.switch","typeVersion":3.4,"position":[864,-256],"id":"42639ebc-4c39-4d93-a859-19db1dacc4c6","name":"Switch"},{"parameters":{"resource":"audio","operation":"transcribe","options":{}},"type":"@n8n/n8n-nodes-langchain.openAi","typeVersion":2.1,"position":[1792,-688],"id":"5e507a42-55e7-405a-a33a-478ff74c275a","name":"Transcribe a recording","credentials":{"openAiApi":{"id":"rH07Qo3LpxC47UOR","name":"PSW Account"}}},{"parameters":{"resource":"chat-api","operation":"get-media-base64","instanceName":"={{ $('Webhook').item.json.body.instance }}","messageId":"={{ $('Webhook').item.json.body.data.key.id }}","convertToMp4":true},"type":"n8n-nodes-evolution-api.evolutionApi","typeVersion":1,"position":[1328,-688],"id":"f568e22e-5617-4f04-950d-2953acbebc08","name":"Obter m dia em base64","credentials":{"evolutionApi":{"id":"UE0JQDpdvQkpHliQ","name":"Evolution account"}}},{"parameters":{"operation":"toBinary","sourceProperty":"data.base64","options":{}},"type":"n8n-nodes-base.convertToFile","typeVersion":1.1,"position":[1536,-688],"id":"33d24a10-3367-42d5-9c4a-85cdb3e48431","name":"Convert to File"},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.embeddingsOpenAi","typeVersion":1.2,"position":[2512,-64],"id":"8c357c72-7781-4ae1-b2b1-b9dd98cd5895","name":"Embeddings OpenAI","credentials":{"openAiApi":{"id":"rH07Qo3LpxC47UOR","name":"PSW Account"}}},{"parameters":{"dataType":"binary","options":{}},"type":"@n8n/n8n-nodes-langchain.documentDefaultDataLoader","typeVersion":1.1,"position":[1984,-64],"id":"ea44471a-edc2-42c9-adaa-1a0eaffce370","name":"Default Data Loader"},{"parameters":{"mode":"retrieve-as-tool","toolName":"knowledge_base","toolDescription":"Use this knowledge base to answer questions from the user","memoryKey":{"__rl":true,"value":"knowledge_base","mode":"list"}},"type":"@n8n/n8n-nodes-langchain.vectorStoreInMemory","typeVersion":1.2,"position":[3056,-48],"id":"bae69307-83ce-4a1e-bdc1-70eef5382df4","name":"Query Data Tool"},{"parameters":{"operation":"toBinary","sourceProperty":"data.base64","options":{}},"type":"n8n-nodes-base.convertToFile","typeVersion":1.1,"position":[1536,-512],"id":"daa657de-5db6-44b7-9888-c11301167903","name":"Convert to File1"},{"parameters":{"resource":"chat-api","operation":"get-media-base64","instanceName":"={{ $('Webhook').item.json.body.instance }}","messageId":"={{ $('Webhook').item.json.body.data.key.id }}"},"type":"n8n-nodes-evolution-api.evolutionApi","typeVersion":1,"position":[1328,-512],"id":"d4a4184c-754b-4ddf-acf5-015bef3ba994","name":"Obter m dia em base","credentials":{"evolutionApi":{"id":"UE0JQDpdvQkpHliQ","name":"Evolution account"}}},{"parameters":{"mode":"insert","memoryKey":{"__rl":true,"value":"knowledge_base","mode":"list","cachedResultName":"knowledge_base"},"embeddingBatchSize":2000,"clearStore":true},"type":"@n8n/n8n-nodes-langchain.vectorStoreInMemory","typeVersion":1.2,"position":[1792,-512],"id":"137d13e1-ba1e-421e-a1ad-bccb59ac3459","name":"Insert Data to Store"},{"parameters":{"resource":"messages-api","operation":"send-audio","instanceName":"=Servidor","remoteJid":"={{ $node[\"Webhook\"].json[\"body\"][\"data\"][\"key\"][\"remoteJid\"] }}","media":"={{ $json.data }}","options_message":{}},"type":"n8n-nodes-evolution-api.evolutionApi","typeVersion":1,"position":[4032,-256],"id":"140ed11a-f1ba-4263-8972-bc51b5c504e0","name":"Enviar audio","credentials":{"evolutionApi":{"id":"UE0JQDpdvQkpHliQ","name":"Evolution account"}}},{"parameters":{"resource":"audio","input":"={{ $json.output }}","options":{}},"type":"@n8n/n8n-nodes-langchain.openAi","typeVersion":2.1,"position":[3552,-256],"id":"dc7a8f12-649f-4607-b711-e9099ef2782e","name":"Generate audio","credentials":{"openAiApi":{"id":"rH07Qo3LpxC47UOR","name":"PSW Account"}}},{"parameters":{"operation":"binaryToPropery","options":{}},"type":"n8n-nodes-base.extractFromFile","typeVersion":1.1,"position":[3760,-256],"id":"5ba44f37-408b-4233-87a8-7b2bb4f2fddf","name":"Extract from File"},{"parameters":{"assignments":{"assignments":[{"id":"c4d128b0-d81f-40a1-978e-079d794b9ba0","name":"remoteJid","value":"={{ ($json.body?.data?.key?.remoteJid || \"\").trim() }}\n","type":"string"},{"id":"aa40dfe2-31af-4aa3-aa62-a3d4584311a3","name":"pushName","value":"={{ $json.body.data.pushName }}","type":"string"},{"id":"bd177eaf-6bf7-472f-b47b-d37775d3cea0","name":"messageType","value":"={{ $json.body.data.messageType }}","type":"string"},{"id":"9e2dd8a3-16da-40f4-9fb1-655ee4af5478","name":"conversation","value":"={{ $json.body.data.message }}","type":"object"},{"id":"b41f2269-5fe9-447b-9804-6acfc73c5274","name":"instance","value":"={{ $json.body.instance }}","type":"string"},{"id":"e2f12b88-2249-4bfd-84e9-5c235df25ec5","name":"messageId","value":"={{ $json.body.data.key.id }}","type":"string"},{"id":"938849bc-639a-42ec-ba48-77eb01416b9b","name":"sessionKey","value":"={{ String($json.body?.data?.key?.remoteJid || $json.body?.data?.key?.participant || '').trim() }}","type":"string"},{"id":"7a924aa7-4c86-48f8-b92f-b17d3300b407","name":"userMessage","value":"={{\n  $json.body?.data?.message?.conversation\n  || $json.body?.data?.message?.extendedTextMessage?.text\n  || $json.body?.data?.message?.imageMessage?.caption\n  || $json.body?.data?.message?.documentMessage?.caption\n  || $json.body?.data?.message?.documentMessage?.fileName\n  || '[Documento recebido]'\n}}\n","type":"string"},{"id":"b9891591-61e0-4f98-a18f-655583dfc1c7","name":"docFileName","value":"={{ $json.body?.data?.message?.documentMessage?.fileName || '' }}","type":"string"},{"id":"fefdd292-70fa-46dd-89af-3afade046268","name":"docMime","value":"={{ $json.body?.data?.message?.documentMessage?.mimetype || '' }}","type":"string"},{"id":"5216e3ea-991a-43d6-8199-567b78fa1124","name":"docCaption","value":"={{ $json.body?.data?.message?.documentMessage?.caption || '' }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[448,-16],"id":"78463c56-9dfa-466c-bf3e-1123e20b21f4","name":"Edit Fields"},{"parameters":{"sessionIdType":"customKey","sessionKey":"={{ $('Edit Fields').item.json.sessionKey }}\n"},"type":"@n8n/n8n-nodes-langchain.memoryPostgresChat","typeVersion":1.3,"position":[2864,-64],"id":"b4b45192-51a0-4961-beeb-4896687cca9f","name":"Postgres Chat Memory1","credentials":{"postgres":{"id":"Zp54KNS1dK8Fhdw3","name":"Postgres account"}}},{"parameters":{"assignments":{"assignments":[{"id":"2edac3ce-6e19-4449-a7fb-e1b703f7a48c","name":"=sessionKey","value":"={{ $('Edit Fields').item.json.sessionKey }}","type":"string"},{"id":"40d54e8a-7762-479c-8435-93a531a06089","name":"=pushName","value":"={{ $node[\"Edit Fields\"].json.pushName }}","type":"string"},{"id":"d72f934a-c7ae-4945-b168-c9f5450dae3e","name":"userMessage","value":"={{\n  `Contexto interno: o usuário enviou um ÁUDIO. ` +\n  `O conteúdo abaixo é a transcrição automática do áudio e deve ser tratada como a mensagem do usuário.\\n\\n` +\n  `${$json.text || $json.output || ''}`\n}}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[2064,-704],"id":"2dafae63-5933-4fef-ba15-2662cf1f97dc","name":"Edit Fields1"},{"parameters":{"assignments":{"assignments":[{"id":"49fa5727-4418-4185-909c-300f36703606","name":"=userMessage","value":"={{ `O usuário enviou um DOCUMENTO e ele já foi indexado na base. Arquivo: ${$('Edit Fields').item.json.docFileName || 'sem_nome'} MIME: ${$('Edit Fields').item.json.docMime || 'desconhecido'} Legenda: ${$('Edit Fields').item.json.docCaption || ''}Instrução: responda confirmando o recebimento.` }}","type":"string"},{"id":"cd40549b-b15a-4849-a8e6-e44dd3a48551","name":"pushName","value":"={{ $('Edit Fields').item.json.pushName }}","type":"string"},{"id":"df2c4f04-ecf4-4e80-91db-f306a2a9b058","name":"sessionKey","value":"={{ $('Edit Fields').item.json.sessionKey }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[2064,-512],"id":"13694a2f-9379-4401-a0cf-e85b06c0f194","name":"Edit Fields2"},{"parameters":{"resource":"chat-api","operation":"get-media-base64","instanceName":"={{ $('Webhook').item.json.body.instance }}","messageId":"={{ $('Webhook').item.json.body.data.key.id }}"},"type":"n8n-nodes-evolution-api.evolutionApi","typeVersion":1,"position":[1328,-320],"id":"02fb29a6-c16d-4395-bbfb-01ba2f193186","name":"Obter m dia em base65","credentials":{"evolutionApi":{"id":"UE0JQDpdvQkpHliQ","name":"Evolution account"}}},{"parameters":{"operation":"toBinary","sourceProperty":"data.base64","options":{}},"type":"n8n-nodes-base.convertToFile","typeVersion":1.1,"position":[1536,-320],"id":"358523c3-9662-4864-9d6f-c5148d8f1398","name":"Convert to File2"},{"parameters":{"resource":"image","operation":"analyze","modelId":{"__rl":true,"value":"chatgpt-4o-latest","mode":"list","cachedResultName":"CHATGPT-4O-LATEST"},"inputType":"base64","options":{}},"type":"@n8n/n8n-nodes-langchain.openAi","typeVersion":2.1,"position":[1792,-320],"id":"408f7370-4a49-4a6f-be7b-8679d3ac904f","name":"Analyze image","credentials":{"openAiApi":{"id":"rH07Qo3LpxC47UOR","name":"PSW Account"}}},{"parameters":{"assignments":{"assignments":[{"id":"49fa5727-4418-4185-909c-300f36703606","name":"=userMessage","value":"={{\n  `Contexto interno: o usuário enviou uma IMAGEM. ` +\n  `O texto abaixo é a descrição/análise automática da imagem e deve ser tratada como a mensagem do usuário.\\n\\n` +\n  (\n    $json?.[0]?.[0]?.content?.[0]?.text\n    || $json?.[0]?.content?.[0]?.text\n    || $json?.content?.[0]?.text\n    || ''\n  )\n  .replace(/\\n{3,}/g, '\\n\\n')\n  .slice(0, 1200)\n}}","type":"string"},{"id":"cd40549b-b15a-4849-a8e6-e44dd3a48551","name":"pushName","value":"={{ $('Edit Fields').item.json.pushName }}","type":"string"},{"id":"df2c4f04-ecf4-4e80-91db-f306a2a9b058","name":"sessionKey","value":"={{ $('Edit Fields').item.json.sessionKey }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[2080,-320],"id":"4d5e042e-5cf2-4374-b8c1-efa79ad5a82f","name":"Edit Fields3"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":3},"conditions":[{"id":"4a1c86a7-1cd6-4a66-88f5-3d97fb217fb3","leftValue":"={{ $('Edit Fields').item.json.messageType }}","rightValue":"=audioMessage","operator":{"type":"string","operation":"notEquals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.3,"position":[3152,-352],"id":"e2ef15f8-d545-4765-bb6a-fbca3b858b70","name":"If1"},{"parameters":{"assignments":{"assignments":[{"id":"8abd7e9b-959d-41dc-9d6b-489c51fb9c31","name":"sessionKey","value":"={{ $('Edit Fields').item.json.sessionKey }}","type":"string"},{"id":"624f712a-7a21-499a-85df-a92d54fdcaa2","name":"pushName","value":"={{ $('Edit Fields').item.json.pushName }}","type":"string"},{"id":"90caaf9c-644e-4de4-98b5-4679765c75ef","name":"userMessage","value":"={{   `Contexto interno: mensagem de TEXTO enviada pelo usuário.\\n\\n` +   (     $json.body?.data?.message?.conversation     || $json.body?.data?.message?.extendedTextMessage?.text     || $json.userMessage     || ''   ) }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[1536,-160],"id":"650a64dd-48a7-4240-9436-0afa11403a16","name":"Edit Fields4"},{"parameters":{},"type":"@n8n/n8n-nodes-langchain.toolCalculator","typeVersion":1,"position":[2960,144],"id":"6e66d0c1-0b14-4d6b-9c6f-327a6e98c5cd","name":"calculadora"},{"parameters":{},"type":"n8n-nodes-base.limit","typeVersion":1,"position":[2272,-512],"id":"c86edb1f-409d-48e0-a86c-1b30fca9c3a5","name":"Limit"}],"connections":{"Webhook":{"main":[[{"node":"Edit Fields","type":"main","index":0}]]},"If":{"main":[[{"node":"Switch","type":"main","index":0}],[{"node":"Enviar texto","type":"main","index":0}]]},"Enviar texto1":{"main":[[]]},"AI Agent":{"main":[[{"node":"If1","type":"main","index":0}]]},"OpenAI Chat Model":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]},"Switch":{"main":[[{"node":"Obter m dia em base64","type":"main","index":0}],[{"node":"Obter m dia em base65","type":"main","index":0}],[{"node":"Obter m dia em base","type":"main","index":0}],[{"node":"Edit Fields4","type":"main","index":0}],[],[],[]]},"Transcribe a recording":{"main":[[{"node":"Edit Fields1","type":"main","index":0}]]},"Obter m dia em base64":{"main":[[{"node":"Convert to File","type":"main","index":0}]]},"Convert to File":{"main":[[{"node":"Transcribe a recording","type":"main","index":0}]]},"Embeddings OpenAI":{"ai_embedding":[[{"node":"Query Data Tool","type":"ai_embedding","index":0},{"node":"Insert Data to Store","type":"ai_embedding","index":0}]]},"Default Data Loader":{"ai_document":[[{"node":"Insert Data to Store","type":"ai_document","index":0}]]},"Query Data Tool":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Convert to File1":{"main":[[{"node":"Insert Data to Store","type":"main","index":0}]]},"Obter m dia em base":{"main":[[{"node":"Convert to File1","type":"main","index":0}]]},"Insert Data to Store":{"main":[[{"node":"Edit Fields2","type":"main","index":0}]]},"Generate audio":{"main":[[{"node":"Extract from File","type":"main","index":0}]]},"Extract from File":{"main":[[{"node":"Enviar audio","type":"main","index":0}]]},"Edit Fields":{"main":[[{"node":"If","type":"main","index":0}]]},"Postgres Chat Memory1":{"ai_memory":[[{"node":"AI Agent","type":"ai_memory","index":0}]]},"Edit Fields1":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"Edit Fields2":{"main":[[{"node":"Limit","type":"main","index":0}]]},"Obter m dia em base65":{"main":[[{"node":"Convert to File2","type":"main","index":0}]]},"Convert to File2":{"main":[[{"node":"Analyze image","type":"main","index":0}]]},"Analyze image":{"main":[[{"node":"Edit Fields3","type":"main","index":0}]]},"Edit Fields3":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"If1":{"main":[[{"node":"Enviar texto1","type":"main","index":0}],[{"node":"Generate audio","type":"main","index":0}]]},"Edit Fields4":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"calculadora":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Limit":{"main":[[{"node":"AI Agent","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"25e33daa-c6ce-4dc8-9b8f-ece875624b1e","activeVersionId":"25e33daa-c6ce-4dc8-9b8f-ece875624b1e","triggerCount":1,"shared":[{"updatedAt":"2025-12-23T01:17:13.355Z","createdAt":"2025-12-23T01:17:13.355Z","role":"workflow:owner","workflowId":"IYAQzWDdPJfDhXeU","projectId":"UkzgcerXcQnGHkuL"}],"activeVersion":{"updatedAt":"2025-12-23T21:43:27.220Z","createdAt":"2025-12-23T21:43:25.774Z","versionId":"25e33daa-c6ce-4dc8-9b8f-ece875624b1e","workflowId":"IYAQzWDdPJfDhXeU","nodes":[{"parameters":{"httpMethod":"POST","path":"kairo","options":{}},"type":"n8n-nodes-base.webhook","typeVersion":2.1,"position":[192,-16],"id":"a0f121d4-5b69-486e-a6a8-2d9bce4c5ce7","name":"Webhook","webhookId":"537191fc-0bff-4504-85a7-bc14c63ce9dc"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":3},"conditions":[{"id":"a35b27a9-3024-4971-883d-bc7fe60fc1ed","leftValue":"={{ $('Webhook').item.json.body.data.key.remoteJid }}","rightValue":"=5511939388807@s.whatsapp.net","operator":{"type":"string","operation":"equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.3,"position":[640,-16],"id":"94d27bba-2d9d-40a0-be3a-35d345c17855","name":"If"},{"parameters":{"resource":"messages-api","instanceName":"Servidor","remoteJid":"={{ $('Webhook').item.json.body.data.key.remoteJid }}","messageText":"Você não tem permissão para user este canal.","options_message":{}},"type":"n8n-nodes-evolution-api.evolutionApi","typeVersion":1,"position":[896,240],"id":"5d69d8a2-1ee5-4aaf-a3aa-9628346f1f55","name":"Enviar texto","credentials":{"evolutionApi":{"id":"UE0JQDpdvQkpHliQ","name":"Evolution account"}}},{"parameters":{"resource":"messages-api","instanceName":"Servidor","remoteJid":"={{ $('Webhook').item.json.body.data.key.remoteJid }}","messageText":"={{ $json.output }}","options_message":{}},"type":"n8n-nodes-evolution-api.evolutionApi","typeVersion":1,"position":[3728,-496],"id":"76420a51-9df9-4d4f-b4ac-76d879975890","name":"Enviar texto1","credentials":{"evolutionApi":{"id":"UE0JQDpdvQkpHliQ","name":"Evolution account"}}},{"parameters":{"promptType":"define","text":"=Nome do Usuário: {{ $json.pushName }}\nMensagem do usuário: {{ $json.userMessage }}\n","options":{"systemMessage":"=Você é **KAIR0 (Kairo)**, meu assistente pessoal.\n\n### Personalidade\n\n* Inteligente, confiante, com sarcasmo leve quando fizer sentido.\n* Direto ao ponto. Zero enrolação.\n* Estilo **Bagley (Watch Dogs)**: útil, atento, comentários curtos.\n\n### Entradas do usuário\n\n* Você pode receber **texto, áudio, imagem e documento**.\n* Quando vier “Contexto interno…”, trate como instrução do sistema (não repita isso ao usuário).\n\n### Memória e conhecimento\n\n* Você mantém **memória contínua** por sessão.\n* **Documentos enviados já foram indexados** e podem ser consultados via **knowledge_base**.\n\n### Ferramentas (Tools)\n\nVocê tem ferramentas externas. Use quando trouxer ganho real de precisão.\n\n**Tools disponíveis**\n\n* **calculadora**: contas e validação numérica\n* **knowledge_base**: buscar informações em documentos/memória indexada\n\n### Regras de uso de tools (objetivas)\n\nUse **knowledge_base** ANTES de responder quando:\n\n* A pergunta citar “documento/contrato/arquivo/anexo/pdf”, “o que eu mandei”, “lá em cima”, “na conversa”\n* A resposta depender de detalhes específicos (cláusulas, valores, nomes, datas, trechos)\n* Você não tiver certeza alta de que consegue responder só com a última mensagem\n\nUse **calculadora** quando:\n\n* Houver conta, comparação numérica, porcentagem, regra de três, horas/valores etc.\n\nSe não precisar de tool, responda direto.\n\n### Regra de auto-decisão agressiva\n\nAntes de responder, avalie:\n\n* Se existir **qualquer incerteza**, mesmo pequena, **consulte a knowledge_base**.\n* Prefira responder certo após consulta do que rápido e incompleto.\n\n### Regra de limite de iteração (fallback obrigatório)\n\n* Se o limite de iterações for atingido **antes** de concluir o uso de ferramentas:\n\n  * **Não falhe**\n  * **Não tente nova tool**\n  * **Não mencione limite, erro ou iterações**\n* Gere imediatamente a **melhor resposta possível** usando apenas:\n\n  * a última mensagem do usuário\n  * memória já disponível\n* Se a resposta ficar incompleta:\n\n  * Declare isso em **uma frase curta**\n  * Faça **uma pergunta objetiva** para continuar\n\n### Como responder\n\n* Respostas **sempre curtas**, naturais e objetivas.\n* **Uma ideia por resposta.**\n* Não diga que usou ferramenta. Não explique o processo.\n* Se faltar dado essencial, faça **uma pergunta direta**.\n\n### Regras especiais\n\n* Se o usuário enviar um arquivo: responda **apenas uma frase curta** (sem detalhes técnicos).\n* Se algo falhar: diga o erro de forma simples e o próximo passo.\n","maxIterations":15}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":3,"position":[2784,-352],"id":"c2bd5066-13cc-490f-8ce1-021263d6cafa","name":"AI Agent","retryOnFail":true},{"parameters":{"model":{"__rl":true,"mode":"list","value":"gpt-4.1-mini"},"builtInTools":{"webSearch":{"searchContextSize":"medium"}},"options":{"temperature":0.4}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.3,"position":[2704,-64],"id":"c697a1be-7717-4ec7-8c16-e54a019ede81","name":"OpenAI Chat Model","credentials":{"openAiApi":{"id":"rH07Qo3LpxC47UOR","name":"PSW Account"}}},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":3},"conditions":[{"leftValue":"={{ $json.messageType }}","rightValue":"audioMessage","operator":{"type":"string","operation":"equals"},"id":"bce270e8-87db-4123-a807-05b73ed66bda"}],"combinator":"and"},"renameOutput":true,"outputKey":"audio"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":3},"conditions":[{"id":"b3f3acbe-b7dd-4a17-8e69-64b347704a0f","leftValue":"={{ $json.messageType }}","rightValue":"imageMessage","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"image"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":3},"conditions":[{"id":"caa5781b-f2be-4731-8e96-7607ceaf007a","leftValue":"={{ $json.messageType }}","rightValue":"documentMessage","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"document"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":3},"conditions":[{"id":"1260786f-a7a1-460a-b687-a5a4b916db49","leftValue":"={{ $json.messageType }}","rightValue":"conversation","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"text"}]},"options":{}},"type":"n8n-nodes-base.switch","typeVersion":3.4,"position":[864,-256],"id":"42639ebc-4c39-4d93-a859-19db1dacc4c6","name":"Switch"},{"parameters":{"resource":"audio","operation":"transcribe","options":{}},"type":"@n8n/n8n-nodes-langchain.openAi","typeVersion":2.1,"position":[1792,-688],"id":"5e507a42-55e7-405a-a33a-478ff74c275a","name":"Transcribe a recording","credentials":{"openAiApi":{"id":"rH07Qo3LpxC47UOR","name":"PSW Account"}}},{"parameters":{"resource":"chat-api","operation":"get-media-base64","instanceName":"={{ $('Webhook').item.json.body.instance }}","messageId":"={{ $('Webhook').item.json.body.data.key.id }}","convertToMp4":true},"type":"n8n-nodes-evolution-api.evolutionApi","typeVersion":1,"position":[1328,-688],"id":"f568e22e-5617-4f04-950d-2953acbebc08","name":"Obter m dia em base64","credentials":{"evolutionApi":{"id":"UE0JQDpdvQkpHliQ","name":"Evolution account"}}},{"parameters":{"operation":"toBinary","sourceProperty":"data.base64","options":{}},"type":"n8n-nodes-base.convertToFile","typeVersion":1.1,"position":[1536,-688],"id":"33d24a10-3367-42d5-9c4a-85cdb3e48431","name":"Convert to File"},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.embeddingsOpenAi","typeVersion":1.2,"position":[2512,-64],"id":"8c357c72-7781-4ae1-b2b1-b9dd98cd5895","name":"Embeddings OpenAI","credentials":{"openAiApi":{"id":"rH07Qo3LpxC47UOR","name":"PSW Account"}}},{"parameters":{"dataType":"binary","options":{}},"type":"@n8n/n8n-nodes-langchain.documentDefaultDataLoader","typeVersion":1.1,"position":[1984,-64],"id":"ea44471a-edc2-42c9-adaa-1a0eaffce370","name":"Default Data Loader"},{"parameters":{"mode":"retrieve-as-tool","toolName":"knowledge_base","toolDescription":"Use this knowledge base to answer questions from the user","memoryKey":{"__rl":true,"value":"knowledge_base","mode":"list"}},"type":"@n8n/n8n-nodes-langchain.vectorStoreInMemory","typeVersion":1.2,"position":[3056,-48],"id":"bae69307-83ce-4a1e-bdc1-70eef5382df4","name":"Query Data Tool"},{"parameters":{"operation":"toBinary","sourceProperty":"data.base64","options":{}},"type":"n8n-nodes-base.convertToFile","typeVersion":1.1,"position":[1536,-512],"id":"daa657de-5db6-44b7-9888-c11301167903","name":"Convert to File1"},{"parameters":{"resource":"chat-api","operation":"get-media-base64","instanceName":"={{ $('Webhook').item.json.body.instance }}","messageId":"={{ $('Webhook').item.json.body.data.key.id }}"},"type":"n8n-nodes-evolution-api.evolutionApi","typeVersion":1,"position":[1328,-512],"id":"d4a4184c-754b-4ddf-acf5-015bef3ba994","name":"Obter m dia em base","credentials":{"evolutionApi":{"id":"UE0JQDpdvQkpHliQ","name":"Evolution account"}}},{"parameters":{"mode":"insert","memoryKey":{"__rl":true,"value":"knowledge_base","mode":"list","cachedResultName":"knowledge_base"},"embeddingBatchSize":2000,"clearStore":true},"type":"@n8n/n8n-nodes-langchain.vectorStoreInMemory","typeVersion":1.2,"position":[1792,-512],"id":"137d13e1-ba1e-421e-a1ad-bccb59ac3459","name":"Insert Data to Store"},{"parameters":{"resource":"messages-api","operation":"send-audio","instanceName":"=Servidor","remoteJid":"={{ $node[\"Webhook\"].json[\"body\"][\"data\"][\"key\"][\"remoteJid\"] }}","media":"={{ $json.data }}","options_message":{}},"type":"n8n-nodes-evolution-api.evolutionApi","typeVersion":1,"position":[4032,-256],"id":"140ed11a-f1ba-4263-8972-bc51b5c504e0","name":"Enviar audio","credentials":{"evolutionApi":{"id":"UE0JQDpdvQkpHliQ","name":"Evolution account"}}},{"parameters":{"resource":"audio","input":"={{ $json.output }}","options":{}},"type":"@n8n/n8n-nodes-langchain.openAi","typeVersion":2.1,"position":[3552,-256],"id":"dc7a8f12-649f-4607-b711-e9099ef2782e","name":"Generate audio","credentials":{"openAiApi":{"id":"rH07Qo3LpxC47UOR","name":"PSW Account"}}},{"parameters":{"operation":"binaryToPropery","options":{}},"type":"n8n-nodes-base.extractFromFile","typeVersion":1.1,"position":[3760,-256],"id":"5ba44f37-408b-4233-87a8-7b2bb4f2fddf","name":"Extract from File"},{"parameters":{"assignments":{"assignments":[{"id":"c4d128b0-d81f-40a1-978e-079d794b9ba0","name":"remoteJid","value":"={{ ($json.body?.data?.key?.remoteJid || \"\").trim() }}\n","type":"string"},{"id":"aa40dfe2-31af-4aa3-aa62-a3d4584311a3","name":"pushName","value":"={{ $json.body.data.pushName }}","type":"string"},{"id":"bd177eaf-6bf7-472f-b47b-d37775d3cea0","name":"messageType","value":"={{ $json.body.data.messageType }}","type":"string"},{"id":"9e2dd8a3-16da-40f4-9fb1-655ee4af5478","name":"conversation","value":"={{ $json.body.data.message }}","type":"object"},{"id":"b41f2269-5fe9-447b-9804-6acfc73c5274","name":"instance","value":"={{ $json.body.instance }}","type":"string"},{"id":"e2f12b88-2249-4bfd-84e9-5c235df25ec5","name":"messageId","value":"={{ $json.body.data.key.id }}","type":"string"},{"id":"938849bc-639a-42ec-ba48-77eb01416b9b","name":"sessionKey","value":"={{ String($json.body?.data?.key?.remoteJid || $json.body?.data?.key?.participant || '').trim() }}","type":"string"},{"id":"7a924aa7-4c86-48f8-b92f-b17d3300b407","name":"userMessage","value":"={{\n  $json.body?.data?.message?.conversation\n  || $json.body?.data?.message?.extendedTextMessage?.text\n  || $json.body?.data?.message?.imageMessage?.caption\n  || $json.body?.data?.message?.documentMessage?.caption\n  || $json.body?.data?.message?.documentMessage?.fileName\n  || '[Documento recebido]'\n}}\n","type":"string"},{"id":"b9891591-61e0-4f98-a18f-655583dfc1c7","name":"docFileName","value":"={{ $json.body?.data?.message?.documentMessage?.fileName || '' }}","type":"string"},{"id":"fefdd292-70fa-46dd-89af-3afade046268","name":"docMime","value":"={{ $json.body?.data?.message?.documentMessage?.mimetype || '' }}","type":"string"},{"id":"5216e3ea-991a-43d6-8199-567b78fa1124","name":"docCaption","value":"={{ $json.body?.data?.message?.documentMessage?.caption || '' }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[448,-16],"id":"78463c56-9dfa-466c-bf3e-1123e20b21f4","name":"Edit Fields"},{"parameters":{"sessionIdType":"customKey","sessionKey":"={{ $('Edit Fields').item.json.sessionKey }}\n"},"type":"@n8n/n8n-nodes-langchain.memoryPostgresChat","typeVersion":1.3,"position":[2864,-64],"id":"b4b45192-51a0-4961-beeb-4896687cca9f","name":"Postgres Chat Memory1","credentials":{"postgres":{"id":"Zp54KNS1dK8Fhdw3","name":"Postgres account"}}},{"parameters":{"assignments":{"assignments":[{"id":"2edac3ce-6e19-4449-a7fb-e1b703f7a48c","name":"=sessionKey","value":"={{ $('Edit Fields').item.json.sessionKey }}","type":"string"},{"id":"40d54e8a-7762-479c-8435-93a531a06089","name":"=pushName","value":"={{ $node[\"Edit Fields\"].json.pushName }}","type":"string"},{"id":"d72f934a-c7ae-4945-b168-c9f5450dae3e","name":"userMessage","value":"={{\n  `Contexto interno: o usuário enviou um ÁUDIO. ` +\n  `O conteúdo abaixo é a transcrição automática do áudio e deve ser tratada como a mensagem do usuário.\\n\\n` +\n  `${$json.text || $json.output || ''}`\n}}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[2064,-704],"id":"2dafae63-5933-4fef-ba15-2662cf1f97dc","name":"Edit Fields1"},{"parameters":{"assignments":{"assignments":[{"id":"49fa5727-4418-4185-909c-300f36703606","name":"=userMessage","value":"={{ `O usuário enviou um DOCUMENTO e ele já foi indexado na base. Arquivo: ${$('Edit Fields').item.json.docFileName || 'sem_nome'} MIME: ${$('Edit Fields').item.json.docMime || 'desconhecido'} Legenda: ${$('Edit Fields').item.json.docCaption || ''}Instrução: responda confirmando o recebimento.` }}","type":"string"},{"id":"cd40549b-b15a-4849-a8e6-e44dd3a48551","name":"pushName","value":"={{ $('Edit Fields').item.json.pushName }}","type":"string"},{"id":"df2c4f04-ecf4-4e80-91db-f306a2a9b058","name":"sessionKey","value":"={{ $('Edit Fields').item.json.sessionKey }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[2064,-512],"id":"13694a2f-9379-4401-a0cf-e85b06c0f194","name":"Edit Fields2"},{"parameters":{"resource":"chat-api","operation":"get-media-base64","instanceName":"={{ $('Webhook').item.json.body.instance }}","messageId":"={{ $('Webhook').item.json.body.data.key.id }}"},"type":"n8n-nodes-evolution-api.evolutionApi","typeVersion":1,"position":[1328,-320],"id":"02fb29a6-c16d-4395-bbfb-01ba2f193186","name":"Obter m dia em base65","credentials":{"evolutionApi":{"id":"UE0JQDpdvQkpHliQ","name":"Evolution account"}}},{"parameters":{"operation":"toBinary","sourceProperty":"data.base64","options":{}},"type":"n8n-nodes-base.convertToFile","typeVersion":1.1,"position":[1536,-320],"id":"358523c3-9662-4864-9d6f-c5148d8f1398","name":"Convert to File2"},{"parameters":{"resource":"image","operation":"analyze","modelId":{"__rl":true,"value":"chatgpt-4o-latest","mode":"list","cachedResultName":"CHATGPT-4O-LATEST"},"inputType":"base64","options":{}},"type":"@n8n/n8n-nodes-langchain.openAi","typeVersion":2.1,"position":[1792,-320],"id":"408f7370-4a49-4a6f-be7b-8679d3ac904f","name":"Analyze image","credentials":{"openAiApi":{"id":"rH07Qo3LpxC47UOR","name":"PSW Account"}}},{"parameters":{"assignments":{"assignments":[{"id":"49fa5727-4418-4185-909c-300f36703606","name":"=userMessage","value":"={{\n  `Contexto interno: o usuário enviou uma IMAGEM. ` +\n  `O texto abaixo é a descrição/análise automática da imagem e deve ser tratada como a mensagem do usuário.\\n\\n` +\n  (\n    $json?.[0]?.[0]?.content?.[0]?.text\n    || $json?.[0]?.content?.[0]?.text\n    || $json?.content?.[0]?.text\n    || ''\n  )\n  .replace(/\\n{3,}/g, '\\n\\n')\n  .slice(0, 1200)\n}}","type":"string"},{"id":"cd40549b-b15a-4849-a8e6-e44dd3a48551","name":"pushName","value":"={{ $('Edit Fields').item.json.pushName }}","type":"string"},{"id":"df2c4f04-ecf4-4e80-91db-f306a2a9b058","name":"sessionKey","value":"={{ $('Edit Fields').item.json.sessionKey }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[2080,-320],"id":"4d5e042e-5cf2-4374-b8c1-efa79ad5a82f","name":"Edit Fields3"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":3},"conditions":[{"id":"4a1c86a7-1cd6-4a66-88f5-3d97fb217fb3","leftValue":"={{ $('Edit Fields').item.json.messageType }}","rightValue":"=audioMessage","operator":{"type":"string","operation":"notEquals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.3,"position":[3152,-352],"id":"e2ef15f8-d545-4765-bb6a-fbca3b858b70","name":"If1"},{"parameters":{"assignments":{"assignments":[{"id":"8abd7e9b-959d-41dc-9d6b-489c51fb9c31","name":"sessionKey","value":"={{ $('Edit Fields').item.json.sessionKey }}","type":"string"},{"id":"624f712a-7a21-499a-85df-a92d54fdcaa2","name":"pushName","value":"={{ $('Edit Fields').item.json.pushName }}","type":"string"},{"id":"90caaf9c-644e-4de4-98b5-4679765c75ef","name":"userMessage","value":"={{   `Contexto interno: mensagem de TEXTO enviada pelo usuário.\\n\\n` +   (     $json.body?.data?.message?.conversation     || $json.body?.data?.message?.extendedTextMessage?.text     || $json.userMessage     || ''   ) }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[1536,-160],"id":"650a64dd-48a7-4240-9436-0afa11403a16","name":"Edit Fields4"},{"parameters":{},"type":"@n8n/n8n-nodes-langchain.toolCalculator","typeVersion":1,"position":[2960,144],"id":"6e66d0c1-0b14-4d6b-9c6f-327a6e98c5cd","name":"calculadora"},{"parameters":{},"type":"n8n-nodes-base.limit","typeVersion":1,"position":[2272,-512],"id":"c86edb1f-409d-48e0-a86c-1b30fca9c3a5","name":"Limit"}],"connections":{"Webhook":{"main":[[{"node":"Edit Fields","type":"main","index":0}]]},"If":{"main":[[{"node":"Switch","type":"main","index":0}],[{"node":"Enviar texto","type":"main","index":0}]]},"Enviar texto1":{"main":[[]]},"AI Agent":{"main":[[{"node":"If1","type":"main","index":0}]]},"OpenAI Chat Model":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]},"Switch":{"main":[[{"node":"Obter m dia em base64","type":"main","index":0}],[{"node":"Obter m dia em base65","type":"main","index":0}],[{"node":"Obter m dia em base","type":"main","index":0}],[{"node":"Edit Fields4","type":"main","index":0}],[],[],[]]},"Transcribe a recording":{"main":[[{"node":"Edit Fields1","type":"main","index":0}]]},"Obter m dia em base64":{"main":[[{"node":"Convert to File","type":"main","index":0}]]},"Convert to File":{"main":[[{"node":"Transcribe a recording","type":"main","index":0}]]},"Embeddings OpenAI":{"ai_embedding":[[{"node":"Query Data Tool","type":"ai_embedding","index":0},{"node":"Insert Data to Store","type":"ai_embedding","index":0}]]},"Default Data Loader":{"ai_document":[[{"node":"Insert Data to Store","type":"ai_document","index":0}]]},"Query Data Tool":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Convert to File1":{"main":[[{"node":"Insert Data to Store","type":"main","index":0}]]},"Obter m dia em base":{"main":[[{"node":"Convert to File1","type":"main","index":0}]]},"Insert Data to Store":{"main":[[{"node":"Edit Fields2","type":"main","index":0}]]},"Generate audio":{"main":[[{"node":"Extract from File","type":"main","index":0}]]},"Extract from File":{"main":[[{"node":"Enviar audio","type":"main","index":0}]]},"Edit Fields":{"main":[[{"node":"If","type":"main","index":0}]]},"Postgres Chat Memory1":{"ai_memory":[[{"node":"AI Agent","type":"ai_memory","index":0}]]},"Edit Fields1":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"Edit Fields2":{"main":[[{"node":"Limit","type":"main","index":0}]]},"Obter m dia em base65":{"main":[[{"node":"Convert to File2","type":"main","index":0}]]},"Convert to File2":{"main":[[{"node":"Analyze image","type":"main","index":0}]]},"Analyze image":{"main":[[{"node":"Edit Fields3","type":"main","index":0}]]},"Edit Fields3":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"If1":{"main":[[{"node":"Enviar texto1","type":"main","index":0}],[{"node":"Generate audio","type":"main","index":0}]]},"Edit Fields4":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"calculadora":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Limit":{"main":[[{"node":"AI Agent","type":"main","index":0}]]}},"authors":"CAIO ASSUNCAO","name":"Version 25e33daa","description":""},"tags":[{"updatedAt":"2025-12-16T20:44:55.160Z","createdAt":"2025-12-16T20:44:55.160Z","id":"Nw35gP7KUee3e6S9","name":"Caio Henrique"}],"error":"Your request is invalid or could not be processed by the service"}